<?xml version="1.0" standalone="yes"?>
<beast>

    <matrixParameter id="L">
        <parameter value="0.00761777  -0.548401  -0.78493    0.306115  -0.216298"/>
        <parameter value="0.0570252    0.351526   0.245018  -1.03049   -2.13245"/>
    </matrixParameter>

    <svdStatistic id="svdStat">
        <matrixParameter idref="L"/>
    </svdStatistic>

    <report>
        <svdStatistic idref="svdStat"/>
    </report>

    <assertEqual tolerance="1e-5" verbose="true" charactersToStrip="\[\],">
        <message>
            Check svd
        </message>
        <actual regex="values:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            2.4100029812397232 1.022446556840847
            0.0234733  0.157104 0.117894 -0.43343  -0.879208
            0.0102419 -0.51842 -0.754695  0.248404 -0.316018
        </expected>
    </assertEqual>

    <assertEqual verbose="true">
        <message>
            Check svd dim names
        </message>
        <actual regex="dimension names:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            svdStat.sv1 svdStat.sv2 svdStat.V11 svdStat.V12 svdStat.V13 svdStat.V14 svdStat.V15 svdStat.V21 svdStat.V22 svdStat.V23 svdStat.V24 svdStat.V25
        </expected>
    </assertEqual>

    <mcmc id="mcmc" chainLength="1" autoOptimize="true">
        <posterior id="posterior">
            <dummyLikelihood>
                <parameter idref="L"/>
            </dummyLikelihood>
        </posterior>
        <operators>
            <fireParameterChanged weight="1"
                                  value="-0.393023  -0.0594516   1.40614   -1.01444  -0.222168
                                          1.71295    0.207991   -0.816126   1.05687  -0.174382">
                <parameter idref="L"/>
            </fireParameterChanged>
        </operators>
        <log id="screenLog" logEvery="100">
            <column label="Posterior" dp="4" width="12">
                <posterior idref="posterior"/>
            </column>
        </log>
    </mcmc>


    <assertEqual tolerance="1e-5" verbose="true" charactersToStrip="\[\],">
        <message>
            Check svd
        </message>
        <actual regex="values:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            2.6410930455014583 1.0145059908277
            0.606059  0.0762813  -0.568481   0.551091  -0.00152952
            0.715266  0.0776536   0.614828  -0.163901  -0.278365
        </expected>
    </assertEqual>


</beast>

