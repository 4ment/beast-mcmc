<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.10.5 Prerelease #23570d1                         -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.community/                                           -->
<beast version="1.10.5">

	<taxa id="taxa">
		<taxon id="A"/>
		<taxon id="B"/>
		<taxon id="C"/>
		<taxon id="D"/>
	</taxa>


	<newBirthDeathSerialSampling id="bdss" units="years" hasFinalSample="false">
		<birthRate>
			<parameter id="bdss.birthRate" value="2.0" lower="0.0"/>
		</birthRate>
		<deathRate>
			<parameter id="bdss.deathRate" value="0.5" lower="0.0" upper="1.0"/>
		</deathRate>
		<samplingRate>
			<parameter id="bdss.psi" value="2.0" lower="0.0"/>
		</samplingRate>
		<origin>
			<parameter id="bdss.origin" value="5.0" lower="0.0"/>
		</origin>
	</newBirthDeathSerialSampling>

	<distributionLikelihood id="bdss.birthRatePrior">
	  <data>
	    <parameter idref="bdss.birthRate"/>
	  </data>
	  <distribution>
	    <logNormalDistributionModel meanInRealSpace="false">
	      <mean>
	        <parameter value="1.0"/>
	      </mean>
	      <stdev>
	        <parameter value="1.5" lower="0.0"/>
	      </stdev>
	    </logNormalDistributionModel>
	  </distribution>
	</distributionLikelihood>

	<distributionLikelihood id="bdss.deathRatePrior">
	  <data>
	    <parameter idref="bdss.deathRate"/>
	  </data>
	  <distribution>
	    <logNormalDistributionModel>
	      <mean>
	        <parameter value="1.0"/>
	      </mean>
	      <stdev>
	        <parameter value="1.5" lower="0.0"/>
	      </stdev>
	    </logNormalDistributionModel>
	  </distribution>
	</distributionLikelihood>

	<distributionLikelihood id="bdss.psiPrior">
	  <data>
	    <parameter idref="bdss.psi"/>
	  </data>
	  <distribution>
	    <logNormalDistributionModel meanInRealSpace="false">
	      <mean>
	        <parameter value="1.0"/>
	      </mean>
	      <stdev>
	        <parameter value="1.5" lower="0.0"/>
	      </stdev>
	    </logNormalDistributionModel>
	  </distribution>
	</distributionLikelihood>

	<distributionLikelihood id="bdss.originPrior">
	  <data>
	    <parameter idref="bdss.origin"/>
	  </data>
	  <distribution>
	    <logNormalDistributionModel meanInRealSpace="false">
	      <mean>
	        <parameter value="1.0"/>
	      </mean>
	      <stdev>
	        <parameter value="1.5" lower="0.0"/>
	      </stdev>
	    </logNormalDistributionModel>
	  </distribution>
	</distributionLikelihood>

	<compoundGradient id="grad.bdss.prior">
		<numericalHessian>
			<gradient>
				<distributionLikelihood idref="bdss.birthRatePrior"/>
				<parameter idref="bdss.birthRate"/>
			</gradient>
		</numericalHessian>
		<numericalHessian>
			<gradient>
				<distributionLikelihood idref="bdss.deathRatePrior"/>
				<parameter idref="bdss.deathRate"/>
			</gradient>
		</numericalHessian>
		<numericalHessian>
			<gradient>
				<distributionLikelihood idref="bdss.psiPrior"/>
				<parameter idref="bdss.psi"/>
			</gradient>
		</numericalHessian>
		<numericalHessian>
			<gradient>
				<distributionLikelihood idref="bdss.originPrior"/>
				<parameter idref="bdss.origin"/>
			</gradient>
		</numericalHessian>
	</compoundGradient>

	<newick id="startingTree">
		((A:1.0,B:2.0):1.0,(C:1.0,D:2.0):2.0)
	</newick>


	<!-- Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<newick idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>

	<!-- Statistic for sum of the branch lengths of the tree (tree length)       -->
	<treeLengthStatistic id="treeLength">
		<treeModel idref="treeModel"/>
	</treeLengthStatistic>


	<!-- Generate a speciation likelihood for Yule or Birth Death                -->
	<speciationLikelihood id="speciation">
		<model>
			<birthDeathSerialSampling idref="bdss"/>
		</model>
		<speciesTree>
			<treeModel idref="treeModel"/>
		</speciesTree>
	</speciationLikelihood>

	<speciationLikelihoodGradient id="grad.birthRate" wrtParameter="birthRate">
		<speciationLikelihood idref="speciation"/>
		<treeModel idref="treeModel"/>
	</speciationLikelihoodGradient>

	<speciationLikelihoodGradient id="grad.deathRate" wrtParameter="deathRate">
		<speciationLikelihood idref="speciation"/>
		<treeModel idref="treeModel"/>
	</speciationLikelihoodGradient>

	<speciationLikelihoodGradient id="grad.samplingRate" wrtParameter="samplingRate">
		<speciationLikelihood idref="speciation"/>
		<treeModel idref="treeModel"/>
	</speciationLikelihoodGradient>

	<speciationLikelihoodGradient id="grad.treatmentProbability" wrtParameter="treatmentProbability">
		<speciationLikelihood idref="speciation"/>
		<treeModel idref="treeModel"/>
	</speciationLikelihoodGradient>

	<speciationLikelihoodGradient id="grad.samplingProbability" wrtParameter="samplingProbability">
		<speciationLikelihood idref="speciation"/>
		<treeModel idref="treeModel"/>
	</speciationLikelihoodGradient>

	<!-- <report>
		<speciationLikelihoodGradient idref="grad.birthRate"/>
	</report>

	<report>
		<speciationLikelihoodGradient idref="grad.deathRate"/>
	</report>

	<report>
		<speciationLikelihoodGradient idref="grad.samplingRate"/>
	</report>

	<report>
		<speciationLikelihoodGradient idref="grad.treatmentProbability"/>
	</report>

	<report>
		<speciationLikelihoodGradient idref="grad.samplingProbability"/>
	</report> -->

</beast>
