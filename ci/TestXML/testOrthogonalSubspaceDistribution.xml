<?xml version="1.0" encoding="utf-8"?>
<beast>


    <matrixParameter id="L">
        <parameter id="L1" value="0.0076177742633394985 0.3515255484089337 0.30611493207760276 -2.132446790112065"/>
        <parameter id="L2" value="0.05702524809146323 -0.784929798992992 -1.0304943902767967 -0.3930227002265834"/>
        <parameter id="L3" value="-0.5484010117038763 0.24501763591278475 -0.21629784327601548 1.712948337244973"/>
    </matrixParameter>

    <cachedPrior>
        <normalPrior id="L.prior.iid" mean="0" stdev="1">
            <matrixParameter idref="L"/>
        </normalPrior>
        <matrixParameter idref="L"/>
    </cachedPrior>

    <independentNormalDistributionModel id="L.prior.ind">
        <variance>
            <matrixParameter>
                <parameter value="0.9422811175280449 0.4421410902646532 0.8007804329506805 2.7225525670385915"/>
                <parameter value="1.231202337345968 0.36260410473936944 0.8399762645021225 0.6511698273904002"/>
                <parameter value="4.08018076687343 2.8773615136269255 1.0476904930321695 1.0953137690468582"/>
            </matrixParameter>
        </variance>
        <mean>
            <parameter value="0" dimension="12"/>
        </mean>
        <data>
            <parameter idref="L"/>
        </data>
    </independentNormalDistributionModel>

    <!--    Shrinkage prior-->

    [4.38683083033458, 3.2783836259166987, 1.5154515781989726]

    <parameter id="globalScale1" value="4.38683083033458" lower="0"/>
    <parameter id="globalScale2" value="3.2783836259166987" lower="0"/>
    <parameter id="globalScale3" value="1.5154515781989726" lower="0"/>


    <parameter id="localScale1"
               value="0.40778119905926774 0.41025239254958745 0.4203543257629633 1.4687772665146133"
               lower="0"/>
    <parameter id="localScale2"
               value="1.5327223709110416 0.8908272437332271 10.911094706956355 2.142519436729143"
               lower="0"/>
    <parameter id="localScale3"
               value="0.40981240308784206 0.49053105170925093 0.7089218016705008 0.5362910862758501"
               lower="0"/>


    <bayesianBridge id="bb1">
        <parameter idref="L1"/>
        <globalScale>
            <transformedParameter idref="globalScale1"/>
        </globalScale>
        <localScale>
            <parameter idref="localScale1"/>
        </localScale>
        <exponent>
            <parameter value="0.5"/>
        </exponent>
    </bayesianBridge>
    <bayesianBridge id="bb2">
        <parameter idref="L2"/>
        <globalScale>
            <transformedParameter idref="globalScale2"/>
        </globalScale>
        <localScale>
            <parameter idref="localScale2"/>
        </localScale>
        <exponent>
            <parameter value="0.5"/>
        </exponent>
    </bayesianBridge>
    <bayesianBridge id="bb3">
        <parameter idref="L3"/>
        <globalScale>
            <transformedParameter idref="globalScale3"/>
        </globalScale>
        <localScale>
            <parameter idref="localScale3"/>
        </localScale>
        <exponent>
            <parameter value="0.5"/>
        </exponent>
    </bayesianBridge>

    <matrixShrinkageLikelihood id="L.prior.shrinkage">
        <matrixParameter idref="L"/>
        <rowPriors>
            <bayesianBridge idref="bb1"/>
            <bayesianBridge idref="bb2"/>
            <bayesianBridge idref="bb3"/>
        </rowPriors>
    </matrixShrinkageLikelihood>

    <normalOrthogonalSubspaceDistribution id="L.prior.1">
        <normalPrior idref="L.prior.iid"/>
        <matrixParameter idref="L"/>
    </normalOrthogonalSubspaceDistribution>

    <normalOrthogonalSubspaceDistribution id="L.prior.2">
        <independentNormalDistributionModel idref="L.prior.ind"/>
        <matrixParameter idref="L"/>
    </normalOrthogonalSubspaceDistribution>

    <normalOrthogonalSubspaceDistribution id="L.prior.3">
        <matrixShrinkageLikelihood idref="L.prior.shrinkage"/>
        <matrixParameter idref="L"/>
    </normalOrthogonalSubspaceDistribution>


    <cachedReport id="report.1">
        <normalOrthogonalSubspaceDistribution idref="L.prior.1"/>
    </cachedReport>


    <assertEqual tolerance="1e-10" verbose="true">
        <message>
            IID prior
        </message>
        <actual regex="likelihood:\s*(.*?)\n">
            <report idref="report.1"/>
        </actual>
        <expected>
            -15.998347488527957
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            IID prior
        </message>
        <actual regex="(?s)column 1:\s*(.*?)\n\n">
            <report idref="report.1"/>
        </actual>
        <expected>
            1 0 0
            0 1 0
            0 0 1
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            IID prior
        </message>
        <actual regex="(?s)column 2:\s*(.*?)\n\n">
            <report idref="report.1"/>
        </actual>
        <expected>
            1 0 0
            0 1 0
            0 0 1
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            IID prior
        </message>
        <actual regex="(?s)column 3:\s*(.*?)\n\n">
            <report idref="report.1"/>
        </actual>
        <expected>
            1 0 0
            0 1 0
            0 0 1
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            IID prior
        </message>
        <actual regex="(?s)column 4:\s*(.*?)\n\n">
            <report idref="report.1"/>
        </actual>
        <expected>
            1 0 0
            0 1 0
            0 0 1
        </expected>
    </assertEqual>


    <cachedReport id="report.2">
        <normalOrthogonalSubspaceDistribution idref="L.prior.2"/>
    </cachedReport>


    <assertEqual tolerance="1e-10" verbose="true">
        <message>
            Shrinkage prior
        </message>
        <actual regex="likelihood:\s*(.*?)\n">
            <report idref="report.2"/>
        </actual>
        <expected>
            -15.618643428080759
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 1:\s*(.*?)\n\n">
            <report idref="report.2"/>
        </actual>
        <expected>
            0.7513432718368017 -0.0596725255733966 -0.3822442092643832
            -0.05967252557339667 0.7843974117344514 -0.11663662374916735
            -0.38224420926438324 -0.1166366237491674 0.5828150985618625
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 2:\s*(.*?)\n\n">
            <report idref="report.2"/>
        </actual>
        <expected>
            1.5901192479584658 -0.37623654172050586 -0.8683988310274241
            -0.3762365417205062 2.623064463898797 -0.39369957373024367
            -0.8683988310274238 -0.3936995737302438 1.1539070655326846
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 3:\s*(.*?)\n\n">
            <report idref="report.2"/>
        </actual>
        <expected>
            1.1386434617356584 -0.02841415588254564 -0.13701337522188267
            -0.028414155882545682 1.1784500505930853 -0.045564932784320424
            -0.13701337522188267 -0.04556493278432043 1.0766784407927372
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 4:\s*(.*?)\n\n">
            <report idref="report.2"/>
        </actual>
        <expected>
            0.6257418655471837 -0.179261374120924 0.2816167267840851
            -0.17926137412092405 1.4898104005687436 -0.03345766057784843
            0.28161672678408517 -0.03345766057784839 0.7004281877909833
        </expected>
    </assertEqual>


    <cachedReport id="report.3">
        <normalOrthogonalSubspaceDistribution idref="L.prior.3"/>
    </cachedReport>

    <assertEqual tolerance="1e-10" verbose="true">
        <message>
            Shrinkage prior
        </message>
        <actual regex="likelihood:\s*(.*?)\n">
            <report idref="report.3"/>
        </actual>
        <expected>
            -24.78687239973531
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 1:\s*(.*?)\n\n">
            <report idref="report.3"/>
        </actual>
        <expected>
            1.1287719301181682 0.3785954628396035 1.0427046941702114
            0.37859546283960366 0.17966379088043033 0.4335947632317265
            1.0427046941702114 0.43359476323172647 1.6363257782248628
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 2:\s*(.*?)\n\n">
            <report idref="report.3"/>
        </actual>
        <expected>
            0.8454274702629951 0.2517980403420127 0.6860242640543914
            0.2517980403420128 0.2101988823685696 0.2867231937532651
            0.6860242640543917 0.2867231937532651 1.1799617526001465
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 3:\s*(.*?)\n\n">
            <report idref="report.3"/>
        </actual>
        <expected>
            0.4874695237335449 0.1442018891594154 0.2558724858950098
            0.14420188915941534 0.050405334034787704 0.1338368410676183
            0.25587248589500927 0.13383684106761817 0.6233893376863174
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 4:\s*(.*?)\n\n">
            <report idref="report.3"/>
        </actual>
        <expected>
            0.5663707181743325 0.20920797687150805 0.6858471648874694
            0.209207976871508 0.10055322129842598 0.2639051476389768
            0.6858471648874694 0.2639051476389769 0.8913932881581181
        </expected>
    </assertEqual>

    <mcmc id="mcmc" chainLength="1" autoOptimize="true">
        <likelihood id="likelihood">
            <normalOrthogonalSubspaceDistribution idref="L.prior.3"/>
        </likelihood>
        <operators>
            <fireParameterChanged weight="1"
                                  value="-0.44738267923159963 0.6436374468251037 -0.16450480870919917 0.8655080462439241
                                        -0.454549337998158 -1.426378176957026 -0.16240458275087258 -0.17865180808229236
                                        -1.5146279580725215 1.5439602691637375 -0.39339506737983243 -0.5001246338040305">
                <parameter idref="L"/>
            </fireParameterChanged>
        </operators>
        <log id="screenLog" logEvery="1000">
            <column label="likelihood" dp="4" width="12">
                <likelihood idref="likelihood"/>
            </column>
        </log>
    </mcmc>

    <cachedReport id="report.3.2">
        <normalOrthogonalSubspaceDistribution idref="L.prior.3"/>
    </cachedReport>

    <assertEqual tolerance="1e-10" verbose="true">
        <message>
            Shrinkage prior
        </message>
        <actual regex="likelihood:\s*(.*?)\n">
            <report idref="report.3.2"/>
        </actual>
        <expected>
            -27.59459179672089
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 1:\s*(.*?)\n\n">
            <report idref="report.3.2"/>
        </actual>
        <expected>
            2.1982706164201327 0.8377863639698971 -0.3011599757598222
            0.8377863639698974 0.4330022054011962 -0.24267760120492074
            -0.30115997575982245 -0.24267760120492082 0.31348867740213676
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 2:\s*(.*?)\n\n">
            <report idref="report.3.2"/>
        </actual>
        <expected>
            1.5491716036873533 0.5541161081740642 -0.19678471712327902
            0.5541161081740638 0.3795316256319463 -0.16436448951365845
            -0.19678471712327894 -0.16436448951365845 0.3068848759124148
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 3:\s*(.*?)\n\n">
            <report idref="report.3.2"/>
        </actual>
        <expected>
            0.7516466703711828 0.2607399515997672 -0.048216929605520945
            0.2607399515997657 0.16282461606185214 -0.14853320583754717
            -0.04821692960551811 -0.14853320583754628 0.24679290902162332
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-10" verbose="true" charactersToStrip="{}">
        <message>
            Shrinkage prior
        </message>
        <actual regex="(?s)column 4:\s*(.*?)\n\n">
            <report idref="report.3.2"/>
        </actual>
        <expected>
            1.2684993490733045 0.5082515604257618 -0.21802715207006648
            0.508251560425762 0.2281838182599051 -0.09055668059472047
            -0.2180271520700665 -0.09055668059472045 0.06163406029766134
        </expected>
    </assertEqual>

</beast>
