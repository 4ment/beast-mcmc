<?xml version="1.0" ?>
<beast>

    <taxa id="taxa">
        <taxon id="A">
            <attr name="host">
                Bat
            </attr>
        </taxon>
        <taxon id="B">
            <attr name="host">
                Bat
            </attr>
        </taxon>
        <taxon id="C">
            <attr name="host">
                Cat
            </attr>
        </taxon>
    </taxa>

    <alignment id="alignment" dataType="nucleotide">
    <sequence>
        <taxon idref="A"/>
        CCA
    </sequence>
    <sequence>
        <taxon idref="B"/>
        CCC
    </sequence>
    <sequence>
        <taxon idref="C"/>
        CCC
    </sequence>
    </alignment>

    <generalDataType id="host.dataType">
        <state code="Bat"/>
        <state code="Cat"/>
    </generalDataType>

    <!-- Data pattern for discrete trait, 'host'                                 -->
    <attributePatterns id="host.pattern" attribute="host">
        <taxa idref="taxa"/>
        <generalDataType idref="host.dataType"/>
    </attributePatterns>


    <expandStateSpace id="expandedAlignment" dataType="stateDependentNucleotide2">
        <alignment>
          <alignment idref="alignment"/>
        </alignment>
        <trait>
          <attributePatterns idref="host.pattern"/>
        </trait>
    </expandStateSpace>

	<patterns id="patterns" from="1">
		<alignment idref="expandedAlignment"/>
	</patterns>

    <newick id="newickTree" usingHeights="true" usingDates="false">
        ((A:1.0,B:1.0):1.0,C:1.0)
    </newick>

    <!-- Generate a tree model                                                   -->
    <treeModel id="treeModel">
        <newick idref="newickTree"/>
        <rootHeight>
            <parameter id="treeModel.rootHeight"/>
        </rootHeight>
        <nodeHeights internalNodes="true">
            <parameter id="treeModel.internalNodeHeights"/>
        </nodeHeights>
        <nodeHeights internalNodes="true" rootNode="true">
            <parameter id="treeModel.allInternalNodeHeights"/>
        </nodeHeights>
    </treeModel>

    <!-- The general time reversible (GTR) substitution model                    -->
    <gtrModel id="gtr1">
        <frequencies>
            <frequencyModel dataType="nucleotide">
                <frequencies>
                    <parameter id="frequencies" value="0.25 0.25 0.25 0.25"/>
                </frequencies>
            </frequencyModel>
        </frequencies>
        <rates>
            <parameter id="gtr1.rates" dimension="6" value="1.0" lower="0.0"/>
        </rates>
    </gtrModel>

    <!-- The general time reversible (GTR) substitution model                    -->
    <gtrModel id="gtr2">
        <frequencies>
            <frequencyModel dataType="nucleotide">
                <frequencies>
                    <parameter idref="frequencies"/>
                </frequencies>
            </frequencyModel>
        </frequencies>
        <rates>
            <parameter id="gtr2.rates" dimension="6" value="1.0" lower="0.0"/>
        </rates>
    </gtrModel>

    <markovModulatedSubstitutionModel id="mm" dataType="stateDependentNucleotide2">
        <switchingRates>
            <parameter id="switchingRates" value="1" dimension="2" lower="0.0"/>
        </switchingRates>

        <GTRModel idref="gtr1"/>
        <GTRModel idref="gtr2"/>
    </markovModulatedSubstitutionModel>

    <!-- site model                                                              -->
    <siteModel id="siteModel">
        <substitutionModel>
            <markovModulatedSubstitutionModel idref="mm"/>
        </substitutionModel>
        <gammaShape gammaCategories="4">
            <parameter id="alpha" value="0.5" lower="0.0"/>
        </gammaShape>
    </siteModel>

    <!--                                                                         -->
    <statistic id="mu" name="mu">
        <siteModel idref="siteModel"/>
    </statistic>

    <!-- The strict clock (Uniform rates across branches)                        -->
    <strictClockBranchRates id="branchRates">
        <rate>
            <parameter id="clock.rate" value="1.0" lower="0.0"/>
        </rate>
    </strictClockBranchRates>

    <!-- Likelihood for tree given sequence data                                 -->
    <treeDataLikelihood id="treeLikelihood" useAmbiguities="false">
<!--        <patterns idref="patterns"/>-->
        <alignment idref="expandedAlignment"/>
        <treeModel idref="treeModel"/>
        <siteModel idref="siteModel"/>
        <strictClockBranchRates idref="branchRates"/>
    </treeDataLikelihood>

    <report>
        <treeDataLikelihood idref="treeLikelihood"/>
    </report>

</beast>
