<?xml version="1.0" encoding="utf-8"?>
<beast>
    <matrixParameter id="X">
        <parameter value="1 0 0 0 0"/>
        <parameter value="0 1 0 0 0"/>
        <parameter value="0 0 1 0 0"/>
    </matrixParameter>

    <distributionLikelihood id="X.prior">
        <data>
            <matrixParameter idref="X"/>
        </data>
        <distribution>
            <normalDistributionModel>
                <mean>
                    <parameter value="2"/>
                </mean>
                <stdev>
                    <parameter value="1e-2"/>
                </stdev>
            </normalDistributionModel>
        </distribution>
    </distributionLikelihood>

    <operators id="operators">
        <reflectiveHamiltonianMonteCarloOperator weight="1.0" nSteps="10" stepSize="0.05" drawVariance="1.0"
                                                 autoOptimize="true"
                                                 gradientCheckCount="100" gradientCheckTolerance="1e-2">
            <gradient>
                <distributionLikelihood idref="X.prior"/>
                <matrixParameter idref="X"/>
            </gradient>

            <matrixParameter idref="X"/>
            <graphicalParameterBounds>
                <parameter value="0"/>
            </graphicalParameterBounds>
        </reflectiveHamiltonianMonteCarloOperator>
    </operators>

    <mcmc id="mcmc" chainLength="10000" autoOptimize="true">
        <posterior id="posterior">
            <prior id="prior">
                <distributionLikelihood idref="X.prior"/>
            </prior>
        </posterior>
        <operators idref="operators"/>
        <log id="screenLog" logEvery="1000">
            <column label="prior" dp="4" width="12">
                <prior idref="prior"/>
            </column>
        </log>
        <log id="fileLog" fileName="geodesic.log" logEvery="10">
            <distributionLikelihood idref="X.prior"/>
            <parameter idref="X"/>
        </log>
    </mcmc>
</beast>