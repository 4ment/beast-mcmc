<?xml version="1.0" standalone="yes"?>

<beast>

	<parameter id="draw" value="1 2 3 4 5 6 7 8 9 10"/>

	<multivariateNormalDistributionModel id="normal">
		<meanParameter>
   			<parameter id="mu" value="10 9 8 7 6 5 4 3 2 1"/>
 		</meanParameter>
 		<precisionParameter>
 			<matrixParameter>
				<parameter value="2.56080650520739 2.29971059339517 -1.46660288265402 1.94190906373727 -1.47304986640106 5.73800481230492 -3.42757214050313 1.38023505531852 2.73594002861004 -3.88504322712838"/>
				<parameter value="2.29971059339518 8.3047433837855 1.01632761670971 -1.66635185586538 -3.70292357072299 5.57429824130936 -1.31196260543776 0.999168419650946 0.26013592123774 -1.58516840021119"/>
				<parameter value="-1.46660288265402 1.01632761670972 2.44068583707679 -2.7029300146619 0.454881999216938 -4.08661873902925 3.09561015291054 -0.713982045506212 -2.57817702989478 3.48581769961422"/>
				<parameter value="1.94190906373727 -1.66635185586539 -2.7029300146619 3.91944768125092 0.102373615297518 4.54144965091747 -3.81651071938563 1.2354165922108 3.42456159270693 -4.06119610981782"/>
				<parameter value="-1.47304986640107 -3.70292357072298 0.45488199921694 0.102373615297515 2.29448363698785 -4.24678026314519 1.7145273004787 -0.583492825470015 -0.895196661522286 2.04308202306436"/>
				<parameter value="5.73800481230492 5.57429824130934 -4.08661873902926 4.54144965091748 -4.24678026314519 14.5517828152262 -8.49510747026092 2.76990421051643 6.39908007303101 -9.70153620301488"/>
				<parameter value="-3.42757214050312 -1.31196260543774 3.09561015291055 -3.81651071938563 1.71452730047869 -8.49510747026091 5.75534895313463 -1.78599943198344 -4.58901183630936 6.4226816885871"/>
				<parameter value="1.38023505531852 0.99916841965094 -0.713982045506215 1.2354165922108 -0.583492825470015 2.76990421051643 -1.78599943198345 1.07899333583511 1.54942829225465 -1.86555949224669"/>
				<parameter value="2.73594002861004 0.260135921237729 -2.57817702989479 3.42456159270693 -0.895196661522284 6.399080073031 -4.58901183630936 1.54942829225465 3.94719781846939 -5.16104006099744"/>
				<parameter value="-3.88504322712838 -1.58516840021118 3.48581769961422 -4.06119610981782 2.04308202306436 -9.70153620301487 6.4226816885871 -1.86555949224668 -5.16104006099744 7.52787509173555"/>
			</matrixParameter>
		</precisionParameter>
	</multivariateNormalDistributionModel>

	<multivariateDistributionLikelihood id="distribution">
		<distribution>
			<multivariateNormalDistributionModel idref="normal"/>
		</distribution>
		<data>
			<parameter idref="draw"/>
 		</data>
	</multivariateDistributionLikelihood>
   
	<operators id="operators.rw">
	
        <randomWalkOperator windowSize="0.75" weight="1">
            <parameter idref="draw"/>
        </randomWalkOperator>

	</operators>    
        
	<operators id="operators.hmc">

 		<hamiltonianMonteCarloOperator weight="1" nSteps="10" stepSize="0.1" drawVariance="1.0">
 			<gradient>
				<distributionLikelihood idref="distribution"/>							
			</gradient>
			<parameter idref="draw"/>
 		</hamiltonianMonteCarloOperator>

	</operators>

	<mcmc id="mcmc.hmc" chainLength="1000000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.hmc">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>                
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.hmc"/>
		<log logEvery="10000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.hmc"/>                
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>			
		</log>
		<log logEvery="1000" fileName="testMvnHmc.log">
			<likelihood idref="likelihood.hmc"/>           
			<parameter idref="draw"/>        
		</log>
	</mcmc>
	
	<report>
		<property name="timer">
			<object idref="mcmc.hmc"/>
		</property>
	</report>	
	
	<mcmc id="mcmc.rw" chainLength="1000000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.rw">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>                
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.rw"/>
		<log logEvery="10000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.rw"/>                
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>			
		</log>
		<log logEvery="1000" fileName="testMvnRw.log">
			<likelihood idref="likelihood.rw"/>           
			<parameter idref="draw"/>        
		</log>
	</mcmc>
	 
	<report>
		<property name="timer">
			<object idref="mcmc.rw"/>
		</property>
	</report>			
 
	<traceAnalysis fileName="testMvnRw.log" stdError="true"/>	
	<traceAnalysis fileName="testMvnHmc.log" stdError="true"/>
	
</beast>

<!--  
burnIn   <= 99900,   maxState  = 999000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.rw	-19.0975	2.3104	-18.6723	-23.7826	-15.1351	278.9728	-19.3442	-16.6877	
draw1	9.7083	3.9068	9.5722	1.6361	17.2269	150.9452	6.751	11.7127	
draw2	9.2258	2.3615	9.2318	4.8168	13.9828	55.0773	7.528	10.6728	*
draw3	7.9064	2.947	8.0209	2.2536	13.8174	93.8474	6.5495	10.6236	*
draw4	7.299	2.3689	7.3273	2.6326	11.7734	126.3025	5.6786	8.7291	
draw5	5.9993	3.3716	5.914	-0.8557	12.3093	95.0205	3.2759	7.591	*
draw6	4.7945	3.6662	4.6689	-2.0233	11.7936	36.6308	1.9623	6.8826	*
draw7	4.1755	3.2968	4.1682	-3.0151	10.2367	74.3359	1.7352	5.8294	*
draw8	3.1343	2.6387	3.1853	-2.1112	8.2675	249.4347	1.2772	4.6733	
draw9	1.8308	3.5727	1.6794	-4.8499	8.9759	184.3137	-0.5999	4.178	
draw10	0.6082	2.7724	0.6934	-4.3989	6.3274	84.0753	-1.4121	2.2145	*

 * WARNING: The results of this MCMC analysis may be invalid as 
            one or more statistics had very low effective sample sizes (ESS)

burnIn   <= 99900,   maxState  = 999000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.hmc	-18.5715	2.0036	-18.3107	-22.5869	-15.243	901	-19.0555	-16.6142	
draw1	10.0373	3.6562	9.8605	3.5077	17.2521	820.5901	6.669	11.5673	
draw2	8.9046	2.4747	8.8463	4.2716	13.78	901	7.1181	10.3836	
draw3	8.09	3.0531	7.9246	2.3951	14.2213	901	6.0727	10.1151	
draw4	6.9697	2.3388	6.8655	2.6219	11.4264	815.5634	5.7969	8.9597	
draw5	5.9788	3.3176	5.9862	-0.1297	12.5293	870.7699	4.5514	8.8765	
draw6	5.0611	3.544	5.128	-2.1342	11.4361	901	3.4506	8.2509	
draw7	3.7682	3.2474	3.7	-2.9293	9.6523	776.5244	1.7582	6.0596	
draw8	2.9808	2.5136	3.02	-1.7106	8.2422	901	1.4969	4.635	
draw9	1.9156	3.5697	1.9245	-4.6894	8.765	901	-0.8814	3.9344	
draw10	1.1524	2.7903	1.1024	-4.2313	6.3403	901	-1.122	2.8166
-->
