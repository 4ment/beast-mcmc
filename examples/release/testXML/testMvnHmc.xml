<?xml version="1.0" standalone="yes"?>

<beast>

	<parameter id="draw" value="1 2 3 4 5 6 7 8 9 10"/>

	<multivariateNormalDistributionModel id="normal">
		<meanParameter>
   			<parameter id="mu" value="10 9 8 7 6 5 4 3 2 1"/>
 		</meanParameter>
 		<precisionParameter>
 			<matrixParameter>
				<parameter value="2.56080650520739 2.29971059339517 -1.46660288265402 1.94190906373727 -1.47304986640106 5.73800481230492 -3.42757214050313 1.38023505531852 2.73594002861004 -3.88504322712838"/>
				<parameter value="2.29971059339518 8.3047433837855 1.01632761670971 -1.66635185586538 -3.70292357072299 5.57429824130936 -1.31196260543776 0.999168419650946 0.26013592123774 -1.58516840021119"/>
				<parameter value="-1.46660288265402 1.01632761670972 2.44068583707679 -2.7029300146619 0.454881999216938 -4.08661873902925 3.09561015291054 -0.713982045506212 -2.57817702989478 3.48581769961422"/>
				<parameter value="1.94190906373727 -1.66635185586539 -2.7029300146619 3.91944768125092 0.102373615297518 4.54144965091747 -3.81651071938563 1.2354165922108 3.42456159270693 -4.06119610981782"/>
				<parameter value="-1.47304986640107 -3.70292357072298 0.45488199921694 0.102373615297515 2.29448363698785 -4.24678026314519 1.7145273004787 -0.583492825470015 -0.895196661522286 2.04308202306436"/>
				<parameter value="5.73800481230492 5.57429824130934 -4.08661873902926 4.54144965091748 -4.24678026314519 14.5517828152262 -8.49510747026092 2.76990421051643 6.39908007303101 -9.70153620301488"/>
				<parameter value="-3.42757214050312 -1.31196260543774 3.09561015291055 -3.81651071938563 1.71452730047869 -8.49510747026091 5.75534895313463 -1.78599943198344 -4.58901183630936 6.4226816885871"/>
				<parameter value="1.38023505531852 0.99916841965094 -0.713982045506215 1.2354165922108 -0.583492825470015 2.76990421051643 -1.78599943198345 1.07899333583511 1.54942829225465 -1.86555949224669"/>
				<parameter value="2.73594002861004 0.260135921237729 -2.57817702989479 3.42456159270693 -0.895196661522284 6.399080073031 -4.58901183630936 1.54942829225465 3.94719781846939 -5.16104006099744"/>
				<parameter value="-3.88504322712838 -1.58516840021118 3.48581769961422 -4.06119610981782 2.04308202306436 -9.70153620301487 6.4226816885871 -1.86555949224668 -5.16104006099744 7.52787509173555"/>
			</matrixParameter>
		</precisionParameter>
	</multivariateNormalDistributionModel>

	<multivariateDistributionLikelihood id="distribution">
		<distribution>
			<multivariateNormalDistributionModel idref="normal"/>
		</distribution>
		<data>
			<parameter idref="draw"/>
 		</data>
	</multivariateDistributionLikelihood>
   
	<operators id="operators.rw">
	
        <randomWalkOperator windowSize="0.75" weight="1">
            <parameter idref="draw"/>
        </randomWalkOperator>

	</operators>    
        
	<operators id="operators.hmc">

 		<hamiltonianMonteCarloOperator weight="1" nSteps="10" stepSize="0.1" drawVariance="1.0">
 			<gradient>
				<distributionLikelihood idref="distribution"/>							
			</gradient>
			<parameter idref="draw"/>
 		</hamiltonianMonteCarloOperator>

	</operators>

	<mcmc id="mcmc.hmc" chainLength="1000000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.hmc">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>                
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.hmc"/>
		<log logEvery="10000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.hmc"/>                
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>			
		</log>
		<log logEvery="1000" fileName="testMvnHmc.log">
			<likelihood idref="likelihood.hmc"/>           
			<parameter idref="draw"/>        
		</log>
	</mcmc>
	
	<report>
		<property name="timer">
			<object idref="mcmc.hmc"/>
		</property>
	</report>	
	
	<mcmc id="mcmc.rw" chainLength="1000000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.rw">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>                
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.rw"/>
		<log logEvery="10000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.rw"/>                
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>			
		</log>
		<log logEvery="1000" fileName="testMvnRw.log">
			<likelihood idref="likelihood.rw"/>           
			<parameter idref="draw"/>        
		</log>
	</mcmc>
	 
	<report>
		<property name="timer">
			<object idref="mcmc.rw"/>
		</property>
	</report>			
 
	<traceAnalysis fileName="testMvnRw.log" stdError="true"/>	
	<traceAnalysis fileName="testMvnHmc.log" stdError="true"/>
	
</beast>

<!--  RW results

16.475 seconds

burnIn   <= 99900,   maxState  = 999000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood	-19.0301	2.3063	-18.6238	-23.4875	-15.0947	277.8554	-19.4057	-16.8611	
draw1	9.6131	3.6786	9.6519	2.2682	16.4266	235.443	8.0644	12.7876	
draw2	8.8019	2.4508	8.8562	3.9829	13.5202	45.046	7.2166	10.5336	*
draw3	8.1453	3.091	8.1315	2.4135	13.9456	68.7076	5.6509	9.9049	*
draw4	6.7544	2.3005	6.767	2.239	10.8898	248.6067	4.9521	8.0068	
draw5	6.354	3.2694	6.2886	0.5255	12.9417	175.958	4.0735	8.0563	
draw6	5.6569	3.5749	5.4895	-1.0745	12.9111	30.4933	4.0618	8.6826	*
draw7	4.0001	3.3843	4.0745	-1.7916	10.9908	98.1315	1.6848	6.2013	*
draw8	3.1852	2.5287	3.1671	-1.186	8.8418	269.9205	1.7184	5.0812	
draw9	2.0205	3.6898	2.0239	-5.5193	8.7521	122.7392	0.2749	5.048	
draw10	1.3671	2.6373	1.3035	-3.7206	6.2644	71.0332	-0.1946	3.4612	*

-->
