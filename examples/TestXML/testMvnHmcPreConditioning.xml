<?xml version="1.0" standalone="yes"?>

<beast>

	<parameter id="draw" value="1 2 3 4 5 6 7 8 9 10"/>

	<multivariateNormalDistributionModel id="normal">
		<meanParameter>
   			<parameter id="mu" value="10 9 8 7 6 5 4 3 2 1"/>
 		</meanParameter>
 		<precisionParameter>
 			<matrixParameter>
				<parameter value="2.56080650520739 2.29971059339517 -1.46660288265402 1.94190906373727 -1.47304986640106 5.73800481230492 -3.42757214050313 1.38023505531852 2.73594002861004 -3.88504322712838"/>
				<parameter value="2.29971059339518 80.3047433837855 1.01632761670971 -1.66635185586538 -3.70292357072299 5.57429824130936 -1.31196260543776 0.999168419650946 0.26013592123774 -1.58516840021119"/>
				<parameter value="-1.46660288265402 1.01632761670972 2.44068583707679 -2.7029300146619 0.454881999216938 -4.08661873902925 3.09561015291054 -0.713982045506212 -2.57817702989478 3.48581769961422"/>
				<parameter value="1.94190906373727 -1.66635185586539 -2.7029300146619 3.91944768125092 0.102373615297518 4.54144965091747 -3.81651071938563 1.2354165922108 3.42456159270693 -4.06119610981782"/>
				<parameter value="-1.47304986640107 -3.70292357072298 0.45488199921694 0.102373615297515 2.29448363698785 -4.24678026314519 1.7145273004787 -0.583492825470015 -0.895196661522286 2.04308202306436"/>
				<parameter value="5.73800481230492 5.57429824130934 -4.08661873902926 4.54144965091748 -4.24678026314519 14.5517828152262 -8.49510747026092 2.76990421051643 6.39908007303101 -9.70153620301488"/>
				<parameter value="-3.42757214050312 -1.31196260543774 3.09561015291055 -3.81651071938563 1.71452730047869 -8.49510747026091 5.75534895313463 -1.78599943198344 -4.58901183630936 6.4226816885871"/>
				<parameter value="1.38023505531852 0.99916841965094 -0.713982045506215 1.2354165922108 -0.583492825470015 2.76990421051643 -1.78599943198345 1.07899333583511 1.54942829225465 -1.86555949224669"/>
				<parameter value="2.73594002861004 0.260135921237729 -2.57817702989479 3.42456159270693 -0.895196661522284 6.399080073031 -4.58901183630936 1.54942829225465 3.94719781846939 -5.16104006099744"/>
				<parameter value="-3.88504322712838 -1.58516840021118 3.48581769961422 -4.06119610981782 2.04308202306436 -9.70153620301487 6.4226816885871 -1.86555949224668 -5.16104006099744 7.52787509173555"/>
			</matrixParameter>
			<!--<matrixParameter>-->
				<!--<parameter value="2.56080650520739 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 800.3047433837855 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 2.44068583707679 0.0 0.0 0.0 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 3.91944768125092 0.0 0.0 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.58152262581522 0.0 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.0 14.5517828152262 0.0 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.0 0.0 5.75534895313463 0.0 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.07899333583511 0.0 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 3.94719781846939 0.0"/>-->
				<!--<parameter value="0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 7.52787509173555"/>-->
			<!--</matrixParameter>-->
		</precisionParameter>
	</multivariateNormalDistributionModel>

	<multivariateDistributionLikelihood id="distribution">
		<distribution>
			<multivariateNormalDistributionModel idref="normal"/>
		</distribution>
		<data>
			<parameter idref="draw"/>
 		</data>
	</multivariateDistributionLikelihood>

	<operators id="operators.rw">

        <randomWalkOperator windowSize="0.75" weight="1">
            <parameter idref="draw"/>
        </randomWalkOperator>

	</operators>

	<operators id="operators.hmc">

 		<hamiltonianMonteCarloOperator weight="1" nSteps="10" stepSize="0.2" mode="vanilla"
 			drawVariance="1.0" autoOptimize="true">
 			<gradient>
				<distributionLikelihood idref="distribution"/>
			</gradient>
			<parameter idref="draw"/>
 		</hamiltonianMonteCarloOperator>

	</operators>

	<operators id="operators.hmc.diagonalPreconditioning">

		<hamiltonianMonteCarloOperator weight="1" nSteps="10" stepSize="0.2" mode="vanilla"
									   drawVariance="1.0" autoOptimize="true" preconditioning="diagonal">
			<hessian>
				<distributionLikelihood idref="distribution"/>
			</hessian>
			<parameter idref="draw"/>
		</hamiltonianMonteCarloOperator>

	</operators>

    <operators id="operators.hmc.fullPreconditioning">

        <hamiltonianMonteCarloOperator weight="1" nSteps="10" stepSize="0.2" mode="vanilla"
                                       drawVariance="1.0" autoOptimize="true" preconditioning="full">
            <hessian>
                <distributionLikelihood idref="distribution"/>
            </hessian>
            <parameter idref="draw"/>
        </hamiltonianMonteCarloOperator>

    </operators>

    <mcmc id="mcmc.hmc.fullPreconditioning" chainLength="50000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.hmc.fullPreconditioning">
                <distributionLikelihood idref="distribution"/>
                <dummyLikelihood>
                    <distributionLikelihood idref="distribution"/>
                    <parameter idref="draw"/>
                </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.hmc.fullPreconditioning"/>
        <log logEvery="100000">
            <column label="posterior" dp="4" width="12">
                <likelihood idref="likelihood.hmc.fullPreconditioning"/>
            </column>
            <column label="Draw" sf="6" width="12">
                <parameter idref="draw"/>
            </column>
        </log>
        <log logEvery="1" fileName="testMvnHmcFullPreconditioning.log">
            <likelihood idref="likelihood.hmc.fullPreconditioning"/>
            <parameter idref="draw"/>
        </log>
    </mcmc>

    <report>
        <property name="timer">
            <object idref="mcmc.hmc.fullPreconditioning"/>
        </property>
    </report>

    <mcmc id="mcmc.hmc.diagonalPreconditioning" chainLength="50000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.hmc.diagonalPreconditioning">
                <distributionLikelihood idref="distribution"/>
                <dummyLikelihood>
                    <distributionLikelihood idref="distribution"/>
                    <parameter idref="draw"/>
                </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.hmc.diagonalPreconditioning"/>
        <log logEvery="100000">
            <column label="posterior" dp="4" width="12">
                <likelihood idref="likelihood.hmc.diagonalPreconditioning"/>
            </column>
            <column label="Draw" sf="6" width="12">
                <parameter idref="draw"/>
            </column>
        </log>
        <log logEvery="1" fileName="testMvnHmcDiagonalPreconditioning.log">
            <likelihood idref="likelihood.hmc.diagonalPreconditioning"/>
            <parameter idref="draw"/>
        </log>
    </mcmc>

    <report>
        <property name="timer">
            <object idref="mcmc.hmc.diagonalPreconditioning"/>
        </property>
    </report>

    <mcmc id="mcmc.hmc" chainLength="50000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.hmc">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.hmc"/>
		<log logEvery="100000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.hmc"/>
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>
		</log>
		<log logEvery="1" fileName="testMvnHmc.log">
			<likelihood idref="likelihood.hmc"/>
			<parameter idref="draw"/>
		</log>
	</mcmc>

	<report>
		<property name="timer">
			<object idref="mcmc.hmc"/>
		</property>
	</report>
<!--&lt;!&ndash;-->

	<mcmc id="mcmc.rw" chainLength="50000" autoOptimize="true">
        <posterior>
            <likelihood id="likelihood.rw">
	            <distributionLikelihood idref="distribution"/>
            	<dummyLikelihood>
					<distributionLikelihood idref="distribution"/>
					<parameter idref="draw"/>
	            </dummyLikelihood>
            </likelihood>
        </posterior>
        <operators idref="operators.rw"/>
		<log logEvery="100000">
			<column label="posterior" dp="4" width="12">
				<likelihood idref="likelihood.rw"/>
			</column>
			<column label="Draw" sf="6" width="12">
				<parameter idref="draw"/>
			</column>
		</log>
		<log logEvery="10" fileName="testMvnRw.log">
			<likelihood idref="likelihood.rw"/>
			<parameter idref="draw"/>
		</log>
	</mcmc>

	<report>
		<property name="timer">
			<object idref="mcmc.rw"/>
		</property>
	</report>

	<traceAnalysis fileName="testMvnRw.log" stdError="true"/>
	<traceAnalysis fileName="testMvnHmc.log" stdError="true"/>
    <traceAnalysis fileName="testMvnHmcDiagonalPreconditioning.log" stdError="true"/>
    <traceAnalysis fileName="testMvnHmcFullPreconditioning.log" stdError="true"/>
 <!--&ndash;&gt;-->

</beast>

<!--
burnIn   <= 5000,   maxState  = 50000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.rw	-15.5879	2.2892	-15.2766	-19.7247	-11.6027	117.647	-15.8378	-13.1595
draw1	9.6331	3.0162	9.5952	3.4522	14.467	26.4293	8.1115	12.1473	*
draw2	8.9903	0.1116	8.9832	8.746	9.2061	149.2823	8.9185	9.0345
draw3	8.691	1.992	8.8611	4.5569	12.2159	62.6641	7.5096	10.1741	*
draw4	7.6291	1.7974	7.6161	4.424	11.2276	58.1122	6.5991	9.0529	*
draw5	5.9329	1.9775	5.8493	2.1647	9.8703	31.309	4.6965	7.2004	*
draw6	5.0642	1.4888	4.9608	2.4833	7.7724	15.423	3.5439	5.6431	*
draw7	4.7103	2.4955	4.2212	0.9779	10.2708	12.4573	2.3513	5.4058	*
draw8	3.2981	2.4979	3.2181	-1.3636	8.0566	49.9533	0.6416	4.2673	*
draw9	1.4695	3.2059	1.8161	-5.5639	6.445	25.7356	-0.1281	3.9721	*
draw10	0.0242	1.729	0.0516	-3.3767	2.9537	17.774	-0.6605	1.7023	*

 * WARNING: The results of this MCMC analysis may be invalid as
            one or more statistics had very low effective sample sizes (ESS)

burnIn   <= 5000,   maxState  = 50000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.hmc	-16.0811	2.2946	-15.7455	-20.5835	-12.1966	3837.378	-16.5203	-13.6749
draw1	10.0608	3.5335	10.1064	2.9709	16.9425	1113.3648	7.7693	12.4427
draw2	8.9999	0.1289	8.9999	8.743	9.2509	45001	8.9155	9.0883
draw3	7.9706	2.0991	7.9741	3.8478	12.1086	2697.583	6.4625	9.2698
draw4	6.9636	2.3054	6.9508	2.3438	11.4207	1574.6756	5.4064	8.4965
draw5	6.1195	3.0999	6.1193	-0.0909	12.0478	1132.0454	4.077	8.2414
draw6	5.0354	2.7971	5.0088	-0.3205	10.6818	992.9462	3.1466	6.8975
draw7	3.9367	3.0994	3.9696	-2.0795	10.0178	1937.1318	1.8231	6.0444
draw8	3.0242	2.5648	3.0099	-1.8255	8.2409	1642.2172	1.1731	4.6444
draw9	1.84	3.4682	1.8447	-4.9281	8.5998	1659.3363	-0.596	4.061
draw10	0.9922	2.4933	0.974	-3.8782	5.8172	1912.6781	-0.5679	2.8015


burnIn   <= 5000,   maxState  = 50000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.hmc.diagonalPreconditioning	-16.0406	2.2683	-15.7129	-20.6182	-12.2496	10433.0518	-16.631	-13.8349
draw1	10.0125	3.4434	10.0075	3.1576	16.6611	3723.9963	7.7563	12.3919
draw2	9.0002	0.1173	9.0002	8.765	9.2245	8174.0939	8.9171	9.0754
draw3	7.9701	2.1031	7.994	3.8073	12.0062	11374.6617	6.6856	9.5386
draw4	6.9666	2.268	6.9562	2.4888	11.3815	4793.8538	5.6181	8.6476
draw5	6.055	3.0268	6.0585	0.0434	11.8592	2751.5818	4.0579	8.1606
draw6	5.0327	2.7045	5.0242	-0.3042	10.2898	2198.2923	3.1194	6.7807
draw7	4.0186	3.0372	4.0226	-1.8955	9.9518	3861.7764	1.827	5.9239
draw8	3.0148	2.547	3.0001	-1.9761	7.9918	7060.4176	1.3133	4.7428
draw9	1.994	3.5378	2.002	-5.009	8.9406	4613.4287	-0.3299	4.4459
draw10	1.0144	2.4855	1.0369	-3.7687	5.9905	4378.9507	-0.5791	2.7453


burnIn   <= 5000,   maxState  = 50000
statistic	mean	stdErr	median	hpdLower	hpdUpper	ESS	50hpdLower	50hpdUpper
likelihood.hmc.fullPreconditioning	-16.096	2.2823	-15.7722	-20.5461	-12.2022	2380.32	-16.6582	-13.8239
draw1	9.9856	3.5497	9.9779	2.8727	16.8422	45001	7.4673	12.2515
draw2	8.9999	0.1266	9	8.7455	9.2416	38578.2085	8.9063	9.0766
draw3	7.9934	2.0833	7.9872	3.9815	12.1442	13227.114	6.5338	9.3042
draw4	7.0008	2.3102	7.0161	2.5347	11.5744	30195.163	5.5912	8.7143
draw5	5.9823	3.1629	5.9761	-0.3388	12.1064	45001	3.9292	8.1797
draw6	4.9927	2.8534	4.9733	-0.7208	10.4616	45001	3.0323	6.8419
draw7	4.0229	3.0867	3.9958	-1.9083	10.1727	18752.7585	1.863	6.0184
draw8	3.0079	2.5861	3.0223	-1.9536	8.1329	22309.6296	1.3554	4.8304
draw9	2.0241	3.5573	2.0171	-5.0552	8.8401	45001	-0.3696	4.4256
draw10	0.9877	2.4955	0.9881	-3.9007	5.9159	29515.5387	-0.5997	2.7216

-->
