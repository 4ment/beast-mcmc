<?xml version="1.0" standalone="yes"?>
<beast>
	<taxa id="taxa">
		<taxon id="A">
			<attr name="X">-0.9216947747262308 -3.702180755908974</attr>
		</taxon>
		<taxon id="B">
			<attr name="X">NA -3.1486519648571036</attr>
		</taxon>
		<taxon id="C">
			<attr name="X">3.2120639563878823 -3.8426078209966636</attr>
		</taxon>
		<taxon id="D">
			<attr name="X">-0.8079990211612194 -5.220055178699147</attr>
		</taxon>
		<taxon id="E">
			<attr name="X">-0.29266208009338546 -4.676520033190973</attr>
		</taxon>
		<taxon id="F">
			<attr name="X">-5.760241711670387 -2.2612355043113865</attr>
		</taxon>
		<taxon id="G">
			<attr name="X">-4.54549357709319 NA</attr>
		</taxon>
	</taxa>

	<newick id="tree">
		((A:2.5,(B:1.5,C:1.5):1.0):0.5,((D:0.5,E:0.5):1.5,(F:1.0,G:1.0):1.0):1.0);
	</newick>

	<treeModel id="treeModel">
		<newick idref="tree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
		<nodeTraits name="X" rootNode="false" internalNodes="false" leafNodes="true" traitDimension="2">
			<parameter id="leafTraits"/>
		</nodeTraits>
	</treeModel>

    <multivariateDiffusionModel id="diffusionModel">
		<precisionMatrix>
			<matrixParameter id="precisionMatrix">
				<parameter id="prec.col1" value="1.0 0.1"/>
				<parameter id="prec.col2" value="0.1 2.0"/>
			</matrixParameter>
		</precisionMatrix>
	</multivariateDiffusionModel>

	<repeatedMeasuresModel id="repeatedMeasures" traitName="X">
		<treeModel idref="treeModel"/>
		<traitParameter>
			<parameter idref="leafTraits"/>
		</traitParameter>
		<samplingPrecision>
			<parameter id="gamma" value="2 3"/>
		</samplingPrecision>
		<multivariateDiffusionModel idref="diffusionModel"/>
	</repeatedMeasuresModel>

	<traitDataLikelihood id="driftLikelihood" traitName="X" forceFullPrecision="true">
		<multivariateDiffusionModel idref="diffusionModel"/>
		<treeModel idref="treeModel"/>
		<repeatedMeasuresModel idref="repeatedMeasures"/>
     	<conjugateRootPrior>
            <meanParameter>
                <parameter id="mean" value="-1.0 -3.0"/>
            </meanParameter>
            <priorSampleSize>
                <parameter value="10.0"/>
            </priorSampleSize>
        </conjugateRootPrior>
	</traitDataLikelihood>

	<report>
		With likelihood =
		<traitDataLikelihood idref="driftLikelihood"/>
	</report>

	<mcmc id="mcmc" chainLength="1000000" autoOptimize="true">
		<posterior id="posterior">
			<prior id="prior">
				<gammaPrior shape="2" scale="0.5" offset="0.0">
					<parameter idref="gamma"/>
				</gammaPrior>
			</prior>
			<likelihood id="likelihood">
				<traitDataLikelihood idref="driftLikelihood"/>
			</likelihood>
		</posterior>
		<operators>
			<scaleOperator scaleFactor="0.75" weight="1.0" autoOptmizie="true">
				<parameter idref="gamma"/>
			</scaleOperator>
		</operators>
		<log id="screenLog" logEvery="10000">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior"/>
			</column>
			<column label="Sampling Precision" dp="4" width="20">
				<parameter idref="gamma"/>
			</column>
		</log>
		<log id="fileLog" logEvery="1000" fileName="precision_log.log">
			<posterior idref="posterior"/>
			<prior idref="prior"/>
			<likelihood idref="likelihood"/>
			<parameter idref="gamma"/>
		</log>
	</mcmc>

</beast>

